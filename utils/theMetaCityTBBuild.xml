<?xml version="1.0"?>
<project name="theMetaCity TB Build" default="package" basedir="./theMetaCityTB">

	<property name="compile.dir" value="classes" />
	<property name="src.dir" value="./src" />
    <property name="classpath.dir" value="/usr/local/tomcat/lib" />
    <property name="weblib.dir" value="../theMetaCityWeb/WEB-INF/lib" />

    <target name="init">
        <delete dir="${compile.dir}" />
        <mkdir dir="${compile.dir}" />
	</target>

    <target name="compile" depends="init">
		<javac srcdir="${src.dir}" destdir="${compile.dir}" classpath="${classpath.dir}/jsp-api.jar" />
	</target>

    <!-- Include on the the classes for development -->
    <target name="package" depends="compile">
        <!-- Include the taglib def list so that the jar actually will work, as it does no get compiled -->
        <copy file="${src.dir}/META-INF/themetacity.tld" toFile="${compile.dir}/META-INF/themetacity.tld" />
        <jar destfile="${weblib.dir}/theMetaCityTB.jar" basedir="${compile.dir}"/>
    </target>

    <!-- Generate javadocs -->
    <target name="javadoc" depends="init">
        <javadoc sourcepath="${src.dir}" destdir="${compile.dir}/javadoc" classpath="${classpath.dir}/jsp-api.jar"/>
    </target>

    <!-- Include the source, classes and javadocs in the jar -->
    <target name="productionpackage" depends="compile, javadoc">
        <!-- Depends on compile so classes are already here -->
        <!-- Include the taglib def list so that the jar actually will work, as it does no get compiled -->
        <copy file="${src.dir}/META-INF/themetacity.tld" toFile="${compile.dir}/META-INF/themetacity.tld" />

        <!-- Copy the source across -->
            <copy todir="${compile.dir}">
                <fileset dir="${src.dir}" excludes="**/*.svn"/>
            </copy>

        <!-- Copy the javadocs across -->
        <!-- Depends on javadoc so they are here also -->

        <!-- Now just package it all up -->
        <jar destfile="${weblib.dir}/theMetaCityTBProduction.jar" basedir="${compile.dir}"/>

    </target>

</project>
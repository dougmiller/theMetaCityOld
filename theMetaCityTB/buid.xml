<!-- Ant build file for the MetaCity Tags and beans
     This build file wil clean, compile and package the jar for production. -->

<project name="theMetaCityTB" basedir=".">

    <property name="src.dir" value="src"/>
    <property name="build.dir" value="classes"/>

    <property name="jar.dir" value="../theMetaCityWeb/WEB-INF/lib"/>

    <!-- This must be set to the diectory that jsp-api.jar is in.
         Usually this is ${tomcat.home}/common/lib -->
    <property name="lib.dir" value="/usr/local/tomcat/lib"/>

    <!-- Cleanup old builds -->
    <target name="clean" description="Clean the compilation directory.">
        <delete dir="${build.dir}"/>
    </target>

    <!-- Compile a new version from source -->
    <target name="compile" depends="clean" description="Compile the source.">
        <mkdir dir="${build.dir}"/>
        <javac srcdir="${src.dir}" destdir="${build.dir}" classpath="${lib.dir}/jsp-api.jar"/>

        <!-- Copy the tag definitions -->
        <!-- The .tld definitions file is not included by default so it must be done manually
             META-INF is created if not present -->
        <copy file="${src.dir}/META-INF/themetacity.tld" todir="${build.dir}/META-INF"/>
    </target>

    <!-- Package up the classes -->
    <!-- ${jar.dir} is currently set to the WEB-INF/lib of the front end application -->
    <target name="jar" depends="compile" description="Package the classes into a working jar.">
        <jar destfile="${jar.dir}/${ant.project.name}.jar" basedir="${build.dir}"/>
    </target>

</project>
